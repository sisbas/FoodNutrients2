<!DOCTYPE html>
<html lang="tr" ng-app="foodNutrientApp">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gƒ±da Nutrient Analiz Uygulamasƒ±</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.3/angular.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .search-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .search-box {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .search-input {
            flex: 1;
            padding: 12px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 25px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.3);
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #f8f9fa;
            color: #6c757d;
            border: 2px solid #e0e0e0;
        }

        .btn-secondary:hover {
            background: #e9ecef;
            border-color: #ced4da;
        }

        .food-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
        }

        .food-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            transition: all 0.3s ease;
            border: 1px solid #e0e0e0;
        }

        .food-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.25);
        }

        .food-title {
            font-size: 1.4em;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .food-icon {
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 50%;
        }

        .scientific-name {
            font-style: italic;
            color: #7f8c8d;
            font-size: 0.95em;
            margin-bottom: 20px;
            padding: 8px 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        .nutrient-section {
            margin-top: 20px;
        }

        .nutrient-header {
            font-size: 1.1em;
            font-weight: 600;
            color: #34495e;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nutrient-count {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8em;
        }

        .nutrient-list {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 10px;
        }

        .nutrient-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            margin-bottom: 6px;
            background: linear-gradient(to right, #f8f9fa, #ffffff);
            border-radius: 6px;
            border-left: 3px solid transparent;
            transition: all 0.2s ease;
        }

        .nutrient-item:hover {
            background: linear-gradient(to right, #e3f2fd, #f8f9fa);
            border-left-color: #667eea;
            transform: translateX(3px);
        }

        .nutrient-name {
            font-weight: 500;
            color: #2c3e50;
            flex: 1;
        }

        .nutrient-value {
            font-weight: 600;
            color: #667eea;
            margin-left: 10px;
        }

        .nutrient-unit {
            color: #7f8c8d;
            font-size: 0.9em;
            margin-left: 5px;
        }

        .no-data {
            text-align: center;
            padding: 40px;
            color: #7f8c8d;
            font-size: 1.1em;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: white;
            font-size: 1.2em;
        }

        .food-stats {
            display: flex;
            justify-content: space-around;
            margin: 15px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: 1.5em;
            font-weight: 700;
            color: #667eea;
        }

        .stat-label {
            font-size: 0.8em;
            color: #7f8c8d;
            margin-top: 4px;
        }

        .toggle-btn {
            background: none;
            border: none;
            color: #667eea;
            cursor: pointer;
            font-size: 0.9em;
            margin-top: 10px;
            text-decoration: underline;
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .food-grid {
                grid-template-columns: 1fr;
            }
            
            .search-box {
                flex-direction: column;
            }
        }
    </style>
</head>
<body ng-controller="FoodController">
    <div class="container">
        <div class="header">
            <h1>ü•ó Gƒ±da Nutrient Analiz Uygulamasƒ±</h1>
            <p>Gƒ±da √ºr√ºnlerinin nutrient i√ßeriklerini ke≈üfedin</p>
        </div>

        <div class="search-section">
            <div class="search-box">
                <input type="text" 
                       class="search-input" 
                       ng-model="searchTerm" 
                       placeholder="Gƒ±da √ºr√ºn√º arayƒ±n (√∂r: hummus, tomato)..."
                       ng-change="filterFoods()">
                <button class="btn btn-primary" ng-click="filterFoods()">
                    üîç Ara
                </button>
                <button class="btn btn-secondary" ng-click="clearSearch()">
                    ‚ùå Temizle
                </button>
            </div>
            
            <div class="food-stats" ng-if="filteredFoods.length > 0">
                <div class="stat-item">
                    <div class="stat-number">{{filteredFoods.length}}</div>
                    <div class="stat-label">Gƒ±da √úr√ºn√º</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">{{getTotalNutrients()}}</div>
                    <div class="stat-label">Toplam Nutrient</div>
                </div>
            </div>
        </div>

        <div ng-if="loading" class="loading">
            ‚è≥ Veriler y√ºkleniyor...
        </div>

        <div ng-if="!loading && filteredFoods.length === 0 && searchTerm" class="no-data">
            üîç "{{searchTerm}}" i√ßin sonu√ß bulunamadƒ±.
        </div>

        <div class="food-grid">
            <div class="food-card" ng-repeat="food in filteredFoods">
                <div class="food-title">
                    <div class="food-icon"></div>
                    {{getFoodNameInTurkish(food.description)}}
                </div>
                
                <div class="scientific-name" ng-if="food.scientificName">
                    üß¨ {{food.scientificName}}
                </div>

                <div class="nutrient-section">
                    <div class="nutrient-header">
                        üìä Nutrient ƒ∞√ßeriƒüi
                        <span class="nutrient-count">{{food.sortedNutrients.length}}</span>
                    </div>
                    
                    <div class="nutrient-list">
                        <div class="nutrient-item" 
                             ng-repeat="nutrient in food.sortedNutrients | limitTo: food.showAll ? food.sortedNutrients.length : 10">
                            <span class="nutrient-name">{{nutrient.name}}</span>
                            <span class="nutrient-value">
                                {{nutrient.amount | number:2}}
                                <span class="nutrient-unit">{{nutrient.unitName}}</span>
                            </span>
                        </div>
                    </div>
                    
                    <button class="toggle-btn" 
                            ng-if="food.sortedNutrients.length > 10"
                            ng-click="food.showAll = !food.showAll">
                        {{food.showAll ? '‚ñ≤ Daha Az G√∂ster' : '‚ñº T√ºm√ºn√º G√∂ster (' + (food.sortedNutrients.length - 10) + ' daha)'}}
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        angular.module('foodNutrientApp', [])
        .controller('FoodController', ['$scope', function($scope) {
            $scope.foods = [];
            $scope.filteredFoods = [];
            $scope.searchTerm = '';
            $scope.loading = true;

            // T√ºrk√ße gƒ±da isimleri s√∂zl√ºƒü√º
            const turkishFoodNames = {
                'hummus': 'Humus',
                'hummus, commercial': 'Ticari Humus',
                'tomatoes': 'Domates',
                'tomatoes, grape': 'Cherry Domates',
                'tomatoes, grape, raw': '√áiƒü Cherry Domates'
            };

            // √ñrnek veri (ger√ßek uygulamada JSON dosyasƒ±ndan y√ºklenecek)
            const sampleData = {
                "FoundationFoods": [
                    {
                        "foodClass": "FinalFood",
                        "description": "Hummus, commercial",
                        "scientificName": "",
                        "foodNutrients": [
                            {"nutrient": {"name": "Energy", "unitName": "kcal"}, "amount": 229},
                            {"nutrient": {"name": "Protein", "unitName": "g"}, "amount": 7.35},
                            {"nutrient": {"name": "Total lipid (fat)", "unitName": "g"}, "amount": 17.1},
                            {"nutrient": {"name": "Carbohydrate, by difference", "unitName": "g"}, "amount": 14.9},
                            {"nutrient": {"name": "Fiber, total dietary", "unitName": "g"}, "amount": 5.40},
                            {"nutrient": {"name": "Water", "unitName": "g"}, "amount": 58.7},
                            {"nutrient": {"name": "Iron, Fe", "unitName": "mg"}, "amount": 2.41},
                            {"nutrient": {"name": "Magnesium, Mg", "unitName": "mg"}, "amount": 71.1},
                            {"nutrient": {"name": "Phosphorus, P", "unitName": "mg"}, "amount": 166},
                            {"nutrient": {"name": "Sodium, Na", "unitName": "mg"}, "amount": 438},
                            {"nutrient": {"name": "Potassium, K", "unitName": "mg"}, "amount": 289},
                            {"nutrient": {"name": "Copper, Cu", "unitName": "mg"}, "amount": 0.348},
                            {"nutrient": {"name": "Manganese, Mn", "unitName": "mg"}, "amount": 1.06},
                            {"nutrient": {"name": "Vitamin E (alpha-tocopherol)", "unitName": "mg"}, "amount": 1.74},
                            {"nutrient": {"name": "Thiamin", "unitName": "mg"}, "amount": 0.150},
                            {"nutrient": {"name": "Riboflavin", "unitName": "mg"}, "amount": 0.115},
                            {"nutrient": {"name": "Niacin", "unitName": "mg"}, "amount": 0.948},
                            {"nutrient": {"name": "Vitamin B-6", "unitName": "mg"}, "amount": 0.143},
                            {"nutrient": {"name": "Folate, total", "unitName": "¬µg"}, "amount": 36.0},
                            {"nutrient": {"name": "Calcium, Ca", "unitName": "mg"}, "amount": 41.0}
                        ]
                    },
                    {
                        "foodClass": "FinalFood",
                        "description": "Tomatoes, grape, raw",
                        "scientificName": "Solanum lycopersicum",
                        "foodNutrients": [
                            {"nutrient": {"name": "Energy", "unitName": "kcal"}, "amount": 27.0},
                            {"nutrient": {"name": "Water", "unitName": "g"}, "amount": 92.5},
                            {"nutrient": {"name": "Protein", "unitName": "g"}, "amount": 0.830},
                            {"nutrient": {"name": "Total lipid (fat)", "unitName": "g"}, "amount": 0.630},
                            {"nutrient": {"name": "Carbohydrate, by difference", "unitName": "g"}, "amount": 5.51},
                            {"nutrient": {"name": "Fiber, total dietary", "unitName": "g"}, "amount": 2.10},
                            {"nutrient": {"name": "Vitamin C, total ascorbic acid", "unitName": "mg"}, "amount": 27.2},
                            {"nutrient": {"name": "Lycopene", "unitName": "¬µg"}, "amount": 4100},
                            {"nutrient": {"name": "Potassium, K", "unitName": "mg"}, "amount": 260},
                            {"nutrient": {"name": "Phosphorus, P", "unitName": "mg"}, "amount": 28.0},
                            {"nutrient": {"name": "Magnesium, Mg", "unitName": "mg"}, "amount": 11.9},
                            {"nutrient": {"name": "Calcium, Ca", "unitName": "mg"}, "amount": 11.0},
                            {"nutrient": {"name": "Iron, Fe", "unitName": "mg"}, "amount": 0.330},
                            {"nutrient": {"name": "Vitamin E (alpha-tocopherol)", "unitName": "mg"}, "amount": 0.980},
                            {"nutrient": {"name": "Vitamin K (phylloquinone)", "unitName": "¬µg"}, "amount": 4.20},
                            {"nutrient": {"name": "Thiamin", "unitName": "mg"}, "amount": 0.075},
                            {"nutrient": {"name": "Riboflavin", "unitName": "mg"}, "amount": 0.065},
                            {"nutrient": {"name": "Niacin", "unitName": "mg"}, "amount": 0.805},
                            {"nutrient": {"name": "Vitamin B-6", "unitName": "mg"}, "amount": 0.060},
                            {"nutrient": {"name": "Folate, total", "unitName": "¬µg"}, "amount": 10.0}
                        ]
                    }
                ]
            };

            $scope.getFoodNameInTurkish = function(englishName) {
                const lowerName = englishName.toLowerCase();
                return turkishFoodNames[lowerName] || englishName;
            };

            $scope.getTotalNutrients = function() {
                return $scope.filteredFoods.reduce((total, food) => total + food.sortedNutrients.length, 0);
            };

            function processFoodData(rawData) {
                return rawData.FoundationFoods.map(food => {
                    const nutrients = food.foodNutrients
                        .filter(fn => fn.amount && fn.amount > 0)
                        .map(fn => ({
                            name: fn.nutrient.name,
                            amount: fn.amount,
                            unitName: fn.nutrient.unitName
                        }))
                        .sort((a, b) => b.amount - a.amount);

                    return {
                        ...food,
                        sortedNutrients: nutrients,
                        showAll: false
                    };
                });
            }

            $scope.filterFoods = function() {
                if (!$scope.searchTerm) {
                    $scope.filteredFoods = $scope.foods;
                } else {
                    const term = $scope.searchTerm.toLowerCase();
                    $scope.filteredFoods = $scope.foods.filter(food => 
                        food.description.toLowerCase().includes(term) ||
                        (food.scientificName && food.scientificName.toLowerCase().includes(term)) ||
                        $scope.getFoodNameInTurkish(food.description).toLowerCase().includes(term)
                    );
                }
            };

            $scope.clearSearch = function() {
                $scope.searchTerm = '';
                $scope.filteredFoods = $scope.foods;
            };

            // Veri y√ºkleme sim√ºlasyonu
            setTimeout(() => {
                $scope.$apply(() => {
                    $scope.foods = processFoodData(sampleData);
                    $scope.filteredFoods = $scope.foods;
                    $scope.loading = false;
                });
            }, 1500);

            // Ger√ßek JSON dosyasƒ± y√ºklemek i√ßin bu kodu kullanabilirsiniz:
            /*
            fetch('FoodData_Central_foundation_food_json_2025-04-24.json')
                .then(response => response.json())
                .then(data => {
                    $scope.$apply(() => {
                        $scope.foods = processFoodData(data);
                        $scope.filteredFoods = $scope.foods;
                        $scope.loading = false;
                    });
                })
                .catch(error => {
                    console.error('Veri y√ºkleme hatasƒ±:', error);
                    $scope.$apply(() => {
                        $scope.loading = false;
                    });
                });
            */
        }]);
    </script>
</body>
</html>
